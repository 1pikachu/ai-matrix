mpirun --allow-run-as-root --tag-output -np 16 -H 11.238.201.7:4,11.238.201.70:4,11.238.201.4:4,11.238.201.67:4 -bind-to none -map-by slot -mca pml ob1 -mca btl ^openib -mca plm_rsh_args "-p 54321" -mca btl_tcp_if_include bond0 -x NCCL_SOCKET_IFNAME=bond0 -x NCCL_IB_DISABLE=1 -x CUDNN_VERSION -x NSIGHT_SYSTEMS_VERSION -x LC_ALL -x LS_COLORS -x LD_LIBRARY_PATH -x NCCL_MAX_NRINGS -x OPENCV_FOR_THREADS_NUM -x MXNET_VERSION -x LESSCLOSE -x HOSTNAME -x MOFED_VERSION -x MXNET_OPTIMIZER_AGGREGATION_SIZE -x MXNET_USE_OPERATOR_TUNING -x MXNET_GPU_COPY_NTHREADS -x MXNET_UPDATE_ON_KVSTORE -x MXNET_EXEC_ENABLE_ADDTO -x PYTHONIOENCODING -x NVIDIA_VISIBLE_DEVICES -x pouch_container_id -x ENV -x CUDA_DRIVER_VERSION -x MXNET_HOROVOD_NUM_GROUPS=16 -x NCCL_VERSION -x MXNET_HOME -x STACK_HARD_LIMIT -x MXNET_CUDNN_SUPPLY_NORMCONV_CONSTANTS=1 -x ONNX_NAMESPACE -x PWD -x DALI_VERSION -x HOME -x NVIDIA_MXNET_VERSION -x TRT_VERSION -x OPENMPI_VERSION -x BASH_ENV -x LIBRARY_PATH -x NCCL_BUFFSIZE -x HOROVOD_BATCH_D2D_MEMCOPIES -x MXNET_USE_TENSORRT -x NVIDIA_BUILD_ID -x MXNET_GPU_WORKER_NTHREADS -x TERM -x NCCL_DISABLE_CHECKS -x CUDA_VERSION -x HOROVOD_CYCLE_TIME=0.1 -x NVIDIA_DRIVER_CAPABILITIES -x HOROVOD_GROUPED_ALLREDUCES -x SHLVL -x NCCL_NET_GDR_READ -x NVIDIA_REQUIRE_CUDA -x CUDA_CACHE_DISABLE -x pouch_container_image -x DALI_BUILD -x CUBLAS_VERSION -x PATH -x MEMLOCK_HARD_LIMIT -x MXNET_CUDNN_AUTOTUNE_DEFAULT -x HOROVOD_NUM_STREAMS=2 -x OMPI_MCA_btl_vader_single_copy_mechanism -x NCCL_SOCKET_IFNAME -x _CUDA_COMPAT_PATH -x LESSOPEN -x OMP_NUM_THREADS -x _ -x HOROVOD_STALL_CHECK_TIME_SECONDS -x HOROVOD_STALL_SHUTDOWN_TIME_SECONDS -x HOROVOD_NUM_NCCL_STREAMS -x HOROVOD_MLSL_BGT_AFFINITY  -x HOROVOD_FUSION_THRESHOLD=67108864 -x NHWC_BATCHNORM_LAUNCH_MARGIN=32  -x MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_FWD=999 -x MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_BWD=25 python train_imagenet.py --gpus 0,1,2,3 --batch-size 208 --kv-store horovod --lr 9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 0.0002 --warmup-epochs 5 --eval-period 4 --eval-offset 3 --optimizer sgdwfastlars --network resnet-v1b-normconv-fl --num-layers 50 --num-epochs 44 --accuracy-threshold 0.759 --seed 1 --dtype float16 --use-dali --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/aimatrix-source-data/imagenet-mxnet/train.rec --data-train-idx /data/aimatrix-source-data/imagenet-mxnet/train.idx --data-val /data/aimatrix-source-data/imagenet-mxnet/val.rec --data-val-idx /data/aimatrix-source-data/imagenet-mxnet/val.idx --dali-prefetch-queue 2 --dali-nvjpeg-memory-padding 256 --dali-threads 3 --dali-cache-size 0 --dali-roi-decode 1 2>&1 | tee 4nodeepoch44_lr9.log
